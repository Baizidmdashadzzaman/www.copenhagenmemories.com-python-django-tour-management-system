{% extends 'frontend/layout/base.html' %}

{% block title %}Booking Confirmation - {{ booking.booking_number }}{% endblock %}

{% block content %}
{% load static %}
{% load translate_tags %}

<div class="breadcrumb-bar breadcrumb-bg-02 text-center">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-12">
                <h2 class="breadcrumb-title mb-2">{% translate "Booking Confirmation" %}</h2>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb justify-content-center mb-0">
                        <li class="breadcrumb-item"><a href="{% url 'home' %}"><i class="isax isax-home5"></i></a></li>
                        <li class="breadcrumb-item"><a href="{% url 'tour_list_fronted' %}">{% translate "Tours" %}</a></li>
                        <li class="breadcrumb-item"><a href="{% url 'tour_detail' booking.tour.pk %}">{{ booking.tour.title }}</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Booking #{{ booking.booking_number }}</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>

<div class="content">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-sm mb-4">
                    <div class="card-body text-center py-5">
                        <div class="mb-4">
                            <i class="isax isax-tick-circle text-success" style="font-size: 4rem;"></i>
                        </div>
                        <h3 class="text-success mb-3">{% translate "Booking Confirmed!" %}</h3>
                        <p class="text-muted mb-2">{% translate "Your booking has been successfully created." %}</p>
                        <p class="fw-medium">{% translate "Booking Number:" %} <span class="text-primary">{{ booking.booking_number }}</span></p>
                    </div>
                </div>

                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">{% translate "Booking Details" %}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Tour" %}</h6>
                                    <p class="mb-0 fw-medium">{{ booking.tour.title }}</p>
                                    {% if booking.tour.category %}
                                    <small class="text-muted">{{ booking.tour.category.name }}</small>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Booking Date" %}</h6>
                                    <p class="mb-0">{{ booking.booking_date|date:"M d, Y" }}</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Tour Date" %}</h6>
                                    <p class="mb-0">{{ booking.tour_date|date:"M d, Y" }}
                                    {% if booking.tour_time %} at {{ booking.tour_time|time:"H:i" }}{% endif %}</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Participants" %}</h6>
                                    <p class="mb-0">{{ booking.total_participants }} person{{ booking.total_participants|pluralize }}</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Contact" %}</h6>
                                    <p class="mb-0">{{ booking.contact_name }}</p>
                                    <small class="text-muted">{{ booking.contact_email }}<br>{{ booking.contact_phone }}</small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <h6 class="text-muted mb-1">{% translate "Status" %}</h6>
                                    <span class="badge bg-warning">{{ booking.get_status_display }}</span>
                                </div>
                            </div>
                        </div>

                        {% if booking.special_requirements %}
                        <div class="mt-3">
                            <h6 class="text-muted mb-1">{% translate "Special Requirements" %}</h6>
                            <p class="mb-0">{{ booking.special_requirements }}</p>
                        </div>
                        {% endif %}
                    </div>
                </div>

                {% if participants %}
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">{% translate "Participants" %}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% for participant in participants %}
                            <div class="col-md-6 mb-3">
                                <div class="border rounded p-3">
                                    <h6 class="mb-2">{{ participant.first_name }} {{ participant.last_name }}</h6>
                                    <p class="mb-1"><small class="text-muted">{% translate "Type" %}:</small> {{ participant.participant_type|title }}</p>
                                    {% if participant.age %}
                                    <p class="mb-1"><small class="text-muted">{% translate "Age" %}:</small> {{ participant.age }}</p>
                                    {% endif %}
                                    {% if participant.email %}
                                    <p class="mb-1"><small class="text-muted">{% translate "Email" %}:</small> {{ participant.email }}</p>
                                    {% endif %}
                                    {% if participant.phone %}
                                    <p class="mb-1"><small class="text-muted">{% translate "Phone" %}:</small> {{ participant.phone }}</p>
                                    {% endif %}
                                    <p class="mb-0"><small class="text-muted">{% translate "Price" %}:</small> {{ booking.currency }} {{ participant.price }}</p>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endif %}

                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">{% translate "Pricing Summary" %}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>{% translate "Subtotal" %}:</span>
                                    <span>{{ booking.currency }} {{ booking.subtotal }}</span>
                                </div>
                                {% if booking.discount_amount > 0 %}
                                <div class="d-flex justify-content-between mb-2 text-success">
                                    <span>{% translate "Discount" %}:</span>
                                    <span>-{{ booking.currency }} {{ booking.discount_amount }}</span>
                                </div>
                                {% endif %}
                                <div class="d-flex justify-content-between mb-2">
                                    <span>{% translate "Tax" %} ({{ booking.tour.supplier.country|default:"DK" }}):</span>
                                    <span>{{ booking.currency }} {{ booking.tax_amount }}</span>
                                </div>
                                <hr>
                                <div class="d-flex justify-content-between fw-bold">
                                    <span>{% translate "Total" %}:</span>
                                    <span>{{ booking.currency }} {{ booking.total_amount }}</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-info">
                                    <h6 class="alert-heading">{% translate "Payment Information" %}</h6>
                                    <p class="mb-1">{% translate "Payment Status" %}: <span class="badge bg-warning">{{ booking.get_payment_status_display }}</span></p>
                                    <p class="mb-0">{% translate "Please complete payment to confirm your booking." %}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm">
                    <div class="card-body text-center">
                        <div class="row">
                            <div class="col-md-4">
                                <a href="{% url 'tour_detail' booking.tour.pk %}" class="btn btn-outline-primary w-100">
                                    <i class="isax isax-arrow-left-3 me-2"></i>{% translate "Back to Tour" %}
                                </a>
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-primary w-100" onclick="window.print()">
                                    <i class="isax isax-printer me-2"></i>{% translate "Print Booking" %}
                                </button>
                            </div>
                            <div class="col-md-4">
                                <a href="{% url 'home' %}" class="btn btn-success w-100">
                                    <i class="isax isax-home5 me-2"></i>{% translate "Back to Home" %}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
@media print {
    .breadcrumb-bar, .card-header, .btn {
        display: none !important;
    }
    .card {
        border: 1px solid #ddd !important;
        box-shadow: none !important;
    }
}
</style>

{% endblock %}


